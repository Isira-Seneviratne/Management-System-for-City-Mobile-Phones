/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package itpshnew.hr;

import java.sql.SQLException;
import java.text.DateFormatSymbols;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;

/**
 *
 * @author isira
 */
public class Salary extends HR {

    /**
     * Creates new form Salary
     */
    public Salary() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        salary_panel = new javax.swing.JPanel();
        jPanel12 = new javax.swing.JPanel();
        jPanel13 = new javax.swing.JPanel();
        jTextField32 = new javax.swing.JTextField();
        jLabel27 = new javax.swing.JLabel();
        jLabel28 = new javax.swing.JLabel();
        save_btn8 = new javax.swing.JButton();
        jTextField10 = new javax.swing.JTextField();
        jLabel25 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        jTextField7 = new javax.swing.JTextField();
        jTextField14 = new javax.swing.JTextField();
        jLabel37 = new javax.swing.JLabel();
        jLabel38 = new javax.swing.JLabel();
        jLabel40 = new javax.swing.JLabel();
        jLabel41 = new javax.swing.JLabel();
        jLabel42 = new javax.swing.JLabel();
        jTextField8 = new javax.swing.JTextField();
        jTextField11 = new javax.swing.JTextField();
        jTextField12 = new javax.swing.JTextField();
        jTextField13 = new javax.swing.JTextField();
        save_btn1 = new javax.swing.JButton();
        save_btn = new javax.swing.JButton();
        jMonthChooser1 = new com.toedter.calendar.JMonthChooser();

        salary_panel.setBackground(new java.awt.Color(202, 254, 227));
        salary_panel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel12.setBackground(new java.awt.Color(187, 237, 211));
        jPanel12.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel13.setBackground(new java.awt.Color(100, 199, 150));
        jPanel13.setMaximumSize(new java.awt.Dimension(159, 39));
        jPanel13.setMinimumSize(new java.awt.Dimension(159, 39));
        jPanel13.setPreferredSize(new java.awt.Dimension(147, 49));
        jPanel13.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jTextField32.setText("           ");
        jPanel13.add(jTextField32, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 20, 140, 25));

        jLabel27.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel27.setText("EmpID");
        jPanel13.add(jLabel27, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 20, 110, 30));

        jLabel28.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel28.setText("Month");
        jPanel13.add(jLabel28, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 60, 110, 30));

        save_btn8.setBackground(new java.awt.Color(71, 179, 71));
        save_btn8.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        save_btn8.setIcon(new javax.swing.ImageIcon(getClass().getResource("/itpshnew/images/icons8_Save_40px.png"))); // NOI18N
        save_btn8.setText(" Calculate Salary");
        save_btn8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                save_btn8ActionPerformed(evt);
            }
        });
        jPanel13.add(save_btn8, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 110, 280, 45));
        jPanel13.add(jTextField10, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 220, 180, 25));

        jLabel25.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel25.setText("Working Hours");
        jPanel13.add(jLabel25, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 180, 140, 30));

        jLabel26.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel26.setText("Ot hours");
        jPanel13.add(jLabel26, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 220, 140, -1));

        jTextField7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField7ActionPerformed(evt);
            }
        });
        jPanel13.add(jTextField7, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 180, 180, 25));
        jPanel13.add(jTextField14, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 260, 180, 25));

        jLabel37.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel37.setText("Gross Salary");
        jPanel13.add(jLabel37, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 260, 140, 30));

        jLabel38.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel38.setText("EPF 8%");
        jPanel13.add(jLabel38, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 300, 140, 30));

        jLabel40.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel40.setText("ETF 12%");
        jPanel13.add(jLabel40, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 340, 140, 30));

        jLabel41.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel41.setText("ETF 3%");
        jPanel13.add(jLabel41, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 380, 140, 30));

        jLabel42.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel42.setText("Net Salary");
        jPanel13.add(jLabel42, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 420, 140, 30));
        jPanel13.add(jTextField8, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 420, 180, 25));
        jPanel13.add(jTextField11, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 380, 180, 25));
        jPanel13.add(jTextField12, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 340, 180, 25));
        jPanel13.add(jTextField13, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 300, 180, 25));

        save_btn1.setBackground(new java.awt.Color(71, 179, 71));
        save_btn1.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        save_btn1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/itpshnew/images/icons8_Save_40px.png"))); // NOI18N
        save_btn1.setText("  Save");
        save_btn1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                save_btn1ActionPerformed(evt);
            }
        });
        jPanel13.add(save_btn1, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 480, 170, 45));

        save_btn.setBackground(new java.awt.Color(71, 179, 71));
        save_btn.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        save_btn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/itpshnew/images/icons8_Print_30px.png"))); // NOI18N
        save_btn.setText("  Print");
        save_btn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                save_btnActionPerformed(evt);
            }
        });
        jPanel13.add(save_btn, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 490, 170, 45));
        jPanel13.add(jMonthChooser1, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 70, 130, -1));

        jPanel12.add(jPanel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 20, 550, 560));

        salary_panel.add(jPanel12, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 640, 610));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 650, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(salary_panel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 620, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(salary_panel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void save_btn8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_save_btn8ActionPerformed

        String empid=jTextField32.getText();
        int mo=jMonthChooser1.getMonth()+1;
        String Str1=new DateFormatSymbols().getMonths()[mo];

        try
        {
            String sql="SELECT WorkingHours,OtHours FROM monthlyatttendance WHERE EmpID='"+empid+"' and Month='"+Str1+"'";
            pst=con.prepareStatement(sql);
            rs=pst.executeQuery();

            while(rs.next())
            {
                String workHours=rs.getString("WorkingHours");
                String OtHours=rs.getString("OtHours");
                int x=Integer.parseInt(OtHours);
                jTextField7.setText(workHours);
                jTextField10.setText(OtHours);

                //                               System.out.println( workHours);
                //                               System.out.println(OtHours);

                String record="SELECT Basic_Sal,otRate FROM currentemployee WHERE EmpID='"+empid+"'";
                pst=con.prepareStatement(record);
                rs1=pst.executeQuery();
                while(rs1.next()){
                    String BasicSal=rs1.getString("Basic_Sal");
                    String otRate=rs1.getString("otRate");

                    int y=Integer.parseInt(otRate);
                    double sal=Double.parseDouble(BasicSal);

                    int otsal=x*y;

                    double grossSal=otsal+sal;
                    String groSalary=String.valueOf(grossSal);
                    jTextField14.setText( groSalary);

                    double epf=sal*(0.08);
                    String epff=String.valueOf(epf);
                    jTextField13.setText( epff);

                    double etf12=sal*(0.12);
                    String etfT=String.valueOf( etf12);
                    jTextField12.setText(etfT);

                    double etf3=sal*(0.03);
                    String etf33=String.valueOf( etf3);
                    jTextField11.setText(etf33);

                    double netSal=grossSal-epf;
                    String NetSal=String.valueOf( netSal);
                    jTextField8.setText(NetSal);
                }
            }
        }
        catch(SQLException e)
        {
            JOptionPane.showMessageDialog(this, "An error occurred while getting the current employees.", "Error", JOptionPane.ERROR_MESSAGE);
        }

    }//GEN-LAST:event_save_btn8ActionPerformed

    private void jTextField7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField7ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField7ActionPerformed

    private void save_btn1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_save_btn1ActionPerformed
        String empid= jTextField32.getText();
        // SimpleDateFormat Date_Format = new SimpleDateFormat("yyyy-MM-dd");
        // String month =  Date_Format.format(jMonthChooser1.ge());

        int mo=jMonthChooser1.getMonth()+1;
        String Str1=new DateFormatSymbols().getMonths()[mo];

        String grosssal= jTextField14.getText();
        String epf = jTextField13.getText();
        String etf1= jTextField12.getText();
        String etf2= jTextField11.getText();
        String netsal  = jTextField8.getText();

        String wrkh= jTextField7.getText();
        String otkh= jTextField10.getText();

        double g=Double.parseDouble(grosssal);
        double e=Double.parseDouble(epf);
        double t1=Double.parseDouble(etf1);
        double t2=Double.parseDouble(etf2);
        double f=Double.parseDouble(netsal);
        double t3=Double.parseDouble(wrkh);
        double f2=Double.parseDouble(otkh);

        //String t="INSERT INTO monthlysal (EmpID,Month,GrossSalary,EPF8%,ETF12%,ETF3%,NetSalary)VALUES ('"+empid+"','"+month+"',"+g+","+e+",'"+t1+"','"+t2+"','"+f+"') ";

        try {
            String t="INSERT INTO monthlysal (EmpID,Month,GrossSalary,EPF8,ETF12,ETF3,NetSalary,wrhr,othr)VALUES ('"+empid+"','"+mo+"',"+g+","+e+","+t1+","+t2+","+f+","+t3+","+f2+") ";
            pst = con.prepareStatement(t);
            pst.execute();

        } catch (SQLException ex) {
            Logger.getLogger(HR.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(null," RECORD NOT INSERTED ");
        }

    }//GEN-LAST:event_save_btn1ActionPerformed

    private void save_btnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_save_btnActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_save_btnActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel42;
    private com.toedter.calendar.JMonthChooser jMonthChooser1;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JTextField jTextField10;
    private javax.swing.JTextField jTextField11;
    private javax.swing.JTextField jTextField12;
    private javax.swing.JTextField jTextField13;
    private javax.swing.JTextField jTextField14;
    private javax.swing.JTextField jTextField32;
    private javax.swing.JTextField jTextField7;
    private javax.swing.JTextField jTextField8;
    private javax.swing.JPanel salary_panel;
    private javax.swing.JButton save_btn;
    private javax.swing.JButton save_btn1;
    private javax.swing.JButton save_btn8;
    // End of variables declaration//GEN-END:variables
}
